<!DOCTYPE HTML>
<!--
	CONTENT:
		AUTHORS: Jordan Bayles, John Zeller
		DESCRIPTION: WEP security project for ECE 478: Network Security

	TEMPLATE:
	Prologue 1.2 by HTML5 UP
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->

<html>
	<head>
		<title>Wireless Network Security</title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta name="description" content="" />
		<meta name="keywords" content="" />
		<link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600" rel="stylesheet" type="text/css" />
		<!--[if lte IE 8]><script src="js/html5shiv.js"></script><![endif]-->
		<script src="js/jquery.min.js"></script>
		<script src="js/skel.min.js"></script>
		<script src="js/skel-panels.min.js"></script>
		<script src="js/init.js"></script>
		<script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js?skin=doxy"></script>
		<noscript>
			<link rel="stylesheet" href="css/skel-noscript.css" />
			<link rel="stylesheet" href="css/style.css" />
			<link rel="stylesheet" href="css/style-wide.css" />
			<link rel="stylesheet" href="css/doxy.css" />
		</noscript>
		<!--[if lte IE 9]><link rel="stylesheet" href="css/ie9.css" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="css/ie8.css" /><![endif]-->
	</head>
	<body>

		<!-- Header -->
			<div id="header" class="skel-panels-fixed">

				<div class="top">

					<!-- Logo -->
						<div id="logo">
							<span class="image avatar48"><img src="images/wifi.png" alt="" /></span>
							<h1 id="title">Wired Equivalent Privacy<h1>
              				<span class="byline">Security Topics</span>
						</div>

					<!-- Nav -->
						<nav id="nav">
							<!--

								Prologue's nav expects links in one of two formats:
								
								1. Hash link (scrolls to a different section within the page)
								
								   <li><a href="#foobar" id="foobar-link" class="skel-panels-ignoreHref"><span class="fa fa-whatever-icon-you-want">Foobar</span></a></li>

								2. Standard link (sends the user to another page/site)

								   <li><a href="http://foobar.tld"><span class="fa fa-whatever-icon-you-want">Foobar</span></a></li>

							-->
							<ul>
								<li><a href="#top" id="top-link" class="skel-panels-ignoreHref"><span class="fa fa-cloud">Intro</span></a></li>
								<li><a href="#background" id="background-link" class="skel-panels-ignoreHref"><span class="fa fa-cogs">Background</span></a></li>
								<li><a href="#protocol" id="protocol-link" class="skel-panels-ignoreHref"><span class="fa fa-exchange">Protocol</span></a></li>
								<li><a href="#exploits" id="exploits-link" class="skel-panels-ignoreHref"><span class="fa fa-exclamation-triangle">Exploits</span></a></li>
								<li><a href="#remedies" id="remedies-link" class="skel-panels-ignoreHref"><span class="fa fa-shield">Remedies</span></a></li>
								<li><a href="#wpa" id="wpa-link" class="skel-panels-ignoreHref"><span class="fa fa-heart">WPA/WPA2</span></a></li>
							</ul>
						</nav>

				</div>

				<div class="bottom">

					<!-- Social Icons
						<ul class="icons">
							<li><a href="#" class="fa fa-twitter solo"><span>Twitter</span></a></li>
							<li><a href="#" class="fa fa-facebook solo"><span>Facebook</span></a></li>
							<li><a href="#" class="fa fa-github solo"><span>Github</span></a></li>
							<li><a href="#" class="fa fa-dribbble solo"><span>Dribbble</span></a></li>
							<li><a href="#" class="fa fa-envelope solo"><span>Email</span></a></li>
						</ul>
					-->

				</div>

			</div>

		<!-- Main -->
			<div id="main">

				<!-- Intro -->
					<section id="top" class="one">
						<div class="container">

							<header>
								<h1>WEP is gone, but why?</h1>
							</header>

							<footer>
								<h2>A breakdown of what WEP was and why it failed</h2
							</footer>

						</div>
					</section>

				<!-- Background -->
					<section id="background" class="two">
						<div class="container">
							<header>
								<h2>Background</h2>
							</header>

							<p>Wired Equivalent Privacy (WEP) was introduced in September 1999
							as a part of the original <a href="http://en.wikipedia.org/wiki/IEEE_802.11" target="_blank">IEEE 802.11</a> standard. The purpose
							of WEP was to provide data confidentiality similar to existing
							wired networks.<sup><a href="#ref-1">1</a></sup>

							<h3>WEP-x origins</h3>

							<p>The original standard was WEP-40; due to US government export
							restrictions on cryptographic technology, the key size
							was limited to 40-bits in the standard 64-bit WEP. In 2000, the
							US government export restrictions were lifted and WEP-104, a
							128-bit system, was introduced by hardware manufacturers.

							<h3> Superceding of WEP </h3>

							<p>In 2003, the Wi-Fi Alliance announced that WEP had been superceded
							by Wi-Fi Protected Access (WPA). In 2004, IEEE 802.11i introduced
							WPA2 and deprecated both WEP-40 and WEP-104, stating that they
							"fail to meet their security goals."<sup><a href="#ref-2">2</a></sup>

						</div>
					</section>

				<!-- Protocol-->
					<section id="protocol" class="three">
						<div class="container">

							<header>
								<h2>Protocol</h2>
							</header>

							<p>The RC4 stream cipher is used by WEP for confidentiality<sup><a href="#ref-3">3</a></sup>, and the CRC-32 checksum provides data integrity<sup><a href="#ref-4">4</a></sup>. For context, a stream cipher is a symmetric key cipher where plaintext digits are combined with a pseudorandom cipher digit stream (known as a keystream) to produce the wanted ciphertext. RC4 is a commonly used stream cipher and is widely used in such protocols as Transport Layer Security (TLS).</p>

							<span class="image centered">
								<img style="width: 60%;" src="images/RC4.png" alt="">
								<p style="text-align: center;"><i>RC4 Lookup Stage, where S is a permutation of 256 possible bytes, i and j are two 8-bit index-pointers, and K is the keystream.</i></p>
							</span>

							<p>The WEP protocol consists of a 24-bit initialization vector (IV), which is pseudorandom, concatenated with a key to produce a seed for the RC4 stream cipher. Once the RC4 keystream is produced, it is XOR'd with the plaintext that is the target of encryption, and the cipher text is the result.</p>

							<span class="image centered"><img src="images/Wep-crypt-alt.png" alt=""></span>

							<p>WEP comes in 3 flavors, WEP-40, WEP-104 and WEP-128. Each has a 24-bit IV, which only gives 2<sup>24</sup> = 16,777,216 possibilities. With a <a href="http://en.wikipedia.org/wiki/Birthday_attack" target="_blank">birthday attack</a> this allows for a 50% chance of finding the correct IV by only guessing 1.1774 * &radic;<span style="text-decoration: overline">2<sup>24</sup></span> â‰ˆ 4,823 24-bit combinations. This very small IV became one of the largest achillies heels of WEP</p>

							<p>Standard 64-bit WEP (IEEE 802.11, or WEP-40), consists of the 24-bit IV concatenated with a 40-bit key, or 10 hexadecimal digits. Once the US government lifted export restrictions on cryptographic technologies, then WEP-104 was introduced with a 104-bit key, or 26 hexadecimal digits. In an attempt to add further security, some vendors provided WEP-232, with a 232-bit key, or 58 hexadecimal digits. All of these flavors however, all suffered from an equally short 24-bit IV.</p>

							<h3>Authentication</h3>

							<p>WEP can be used with two different types of authentication, open system and shared key.</p>

							<h4>Open System</h4>

							<p>With open system, a WLAN client does not need to have any credentials, allowing any client to authenticate and attempt to associate using only a MAC. This effectively provides zero authentication, and after association, WEP keys can be used to encrypt subsequent data frames.</p>

							<span class="image centered"><img style="width: 80%;" src="images/opensystem.png" alt=""></span>

							<h4>Shared Key</h4>

							<p>With shared key, the WLAN client and access point (AP) share a key and authenticate through a 4-step challenge and response handshake. The WLAN client starts by sending an authentication request to the AP, and the AP responds by sending back an unencrypted cleartext challenge. The WLAN client then encrypts the cleartext challenge using its shared key and sends it back to the AP. Once the AP receives the encrypted response, it decryptes the message with its shared key and compares the resulting cleartext to the original cleartext challenge. If the cleartexts both match, then the AP sends back a positive reply and the WLAN client is free to associate with the AP.</p>

							<span class="image centered"><img style="width: 80%;" src="images/sharedkey.png" alt=""></span>

							<p>At the face of it, shared key authentication seems like the more secure approach. However, the contrary is true, shared key authentication is more secure, because the keystream can be derived in shared key authentication by eavesdropping and collecting challenge frames sent between the WLAN client and the AP<sup><a href="#ref-5">5</a></sup>. Shared key was eventually deprecated in favor of WPA/WPA2.</p>

						</div>
					</section>

				<!-- Exploits -->
					<section id="exploits" class="three">
						<div class="container">

							<header>
								<h2>Exploits</h2>
							</header>

							<p>There are several attack vectors for WEP. Because it is based
							on an RC4 stream cipher, the same traffic key cannot be reused
							securely. The cipher is seeded with an IV--transmitted as plain
							text--which is only 24 bits in the most common variation of WEP:
							not enough to be secure on a busy network. For a 24-bit IV, there
							is a 50 percent probability of repetition after only 5000 packets
							due to the birthday principle. The way the IV is utilized also
							opens WEP up to a related key attack, where a mathematical
							relationship between keys can be known to the attacker.

							<p>Other major issues include that the use of WEP is optional on
							most routers, so many installations don't even bother using it
							at all. Even if it is being used, the default implementation of
							WEP uses a single shared key among users which leads to issues
							dealing with compromises. Often compromises aren't dealt with at all.

							<p>Most attacks deal with issues due to the RC4 stream cipher utilization
							technique, but Bittau, Handley, and Lackey showed in 2006 that
							the 802.11 protocol can be used to enable attacks against WEP
							that weren't thought previously possible. Only a single packet
							needs to be eavesdropped before bootstrapping to arbitrary data.

							<h3>RC4 based exploits</h3>

							<p>Most exploits are based on the RC4 stream itself. Fluhrer,
							Mantin and Shamir (FMS) found correlations between the RC4
							keystream, IV, and shared key allowing a passive, eavesdropping
							based attack to recover the RC4 key. Depending on the
							amount of traffic on the network successful key recovery can
							take only a minute or so. A key element of this attack strategy
							is to stimulate the server by injecting packets, causing more
							traffic to be available to monitor them. This attack can be
							done easily with consumer hardware.

							<p>Improvements to FMS were made by Andreas Klein in 2005, showing
							that there are additional correlations in the RC4 stream cipher
							than FMS had found previously. This increases the ease of cracking
							the cipher.

							<p>Klein's attack was improved by Tews, Pychkine and Weinmann (TPW)
							in 2007, extending the capability of this attack method. The
							new implementation allows recovering a WEP-104 key with a
							high probability of 50% with only 40,000 packets, reaching
							95% probability with only 95,000 packets.

							<h3>aircrack-ng suite</h3>
							Aircrack-ng is a WEP and WPA-PSK cracking suite that enables
							users to collect packets from a server and perform analysis to
							recover keys from stored packets. It is one of the fastest
							free, consumer WEP cracking tools, implementing the FMS attack
							mentioned above, albeit with optimizations including KoreK, and
							the PTW attack. Aircrack-ng is used by many security companies
							to audit wireless networks.

							<p>At its simplest, aircrack-ng is intuitive and simply for power
							users. Assuming you are close enough to the access point to
							transmit and receive packets, the network has at least one
							client attached, your drivers are properly set up for injection,
							and you are using a current version of aircrack-ng, the
							process is simple to crack WEP. We will discuss the tool
							by walking through the process of cracking a simple WEP-40
							connection.

<h4>airmon-ng</h4>
<p>The first step is to set the wireless card into monitor mode
on the channel of the AP you want to crack. Typically this
is 6 if you are war driving, though you can check the channel
of a particular network easily. First you must put down the
network card with</p>
<pre class="prettyprint linenums">
airmon-ng stop (network interface)
</pre>

<p>Then you place the wireless card into monitor mode with
<pre class="prettyprint linenums">
airmon-ng start (network interface) (AP channel)
</pre>

<h4>airodump-ng</h4>
<p>After the wireless card is prepared to monitor packets, you can
start monitoring packets over the connection using airodump-ng.
The syntax is
<pre class="prettyprint linenums">
airodump-ng -c (AP channel) --bssid (BSSID of AP) -w (output filename) (network interface)
</pre>

Airodump in progress
<span class="image centered"><img src="images/aircrack/airodump_working.png" alt=""></img></span>

<h4>aireplay-ng</h4>
<p>After monitoring has started, packets are being collected. Given enough time
this will likely be enough to collected sufficient packets for recovering the
key, however this is not necessary. Typically while cracking you want to
use aireplay-ng to get a fake authentication, which allows the hacking
laptop to associate with the desired AP and have it accept packets. This gives
more response packets from the server and allows for packet injection.

<pre class="prettyprint linenums">
aireplay-ng -1 0 -e (ESSID of AP) -a (BSSID of AP) -h (MAC of network interface) (network interface)
</pre>

<p>After we have fake associated, everything is ready to begin packet injection.
The easiest way to do this is when a client is currently on the access point,
meaning that address resolution protocol (ARP) requests are being sent
out from the server. ARP packets are ideal because the AP typically broadcasts
them to build the ARP request result, simultaneously spawning a new IV for
collection. We wait for ARP requests to come across the monitor, and then
when we find one we inject it for more packets. There are also tricks for
generating ARPs without a client present, but if conditions are met you
can starting injecting using
<pre class="prettyprint linenums">
aireplay-ng -3 -b (BSSID of AP) -h (MAC of network interface) (network interface)
</pre>

<h4>aircrack-ng</h4>
<p>After collecting enough IVs ("enough" depends on your attack strategy, but
typically 50,000 may be enough) we can now obtain the WEP key directly. This
is done using FMS or PTW implicitly through the aircrack-ng command. For
PTW:
<pre class="prettyprint linenums">
aircrack-ng -b (BSSID of AP) (output filename)*.cap
</pre>

<p>To use the FMS/KoreK method, you can start another console session and use
<pre class="prettyprint linenums">
aircrack-ng -K -b (BSSID of AP) (output filename)*.cap
</pre>

<p>Aircrack with FMS works by using statistical correlations between the RC4
stream cipher and the key to "vote" on the probatility of specific bytes
being at certain positions in the shared key. This allows for a more
educated attack than brute force, in which keys are generated from high probability
bytes and tested against the target AP. In basic WEP configurations the
AP will NOT lock out the aircrack-ng instance, allowing this process to be
completed fairly quickly. Aircrack FMS in progress shows the keys being
tested.
<span class="image centered"><img src="images/aircrack/aircrack-fms.png" alt=""></img></span>

If everything has gone correctly to this point, you should get the key
as a result:
<span class="image centered"><img src="images/aircrack/success.png" alt=""></img></span>

						</div>
					</section>

				<!-- Remedies -->
					<section id="remedies" class="four">
						<div class="container">

							<header>
								<h2>Remedies</h2>
							</header>

							<p>Before settling on a new standard several remedies were considered
							for the issues involved in WEP.

							<h3>WEPPlus</h3>

							<p>WEPPlus was a proprietary enhancement to WEP put forward by
							Agere Systems. WEPPlus avoids the usage of "weak IVs"<sup><a href="#ref-6">6</a></sup> that
							are more likely to leak key information, with the additional
							cost of both ends of a connection needing to support this
							very limited scope standard.

							<h3>DynamicWEP</h3>
							DynamicWEP combined 802.1x technology with the Extensible
							Authentication Protocol (EAP), which is still used for
							some authentication schemes in more modern WPAx installations.
							DynamicWEP uses an authentication token that allows changing
							WEP keys dynamically, a feature that was picked up in 802.11i
							as a part of TKIP but not ever officially a part of WEP, remaining
							a vendor specific feature.

							<h3>WEP2</h3>
							WEP2 was designed for hardware incapable of supporting WPA/WPA2,
							basically being a stopgap measure. WEP2 extends both the IV
							and the key to 128-bits<sup><a href="#ref-7">7</a></sup>, dramatically increasing the key
							space. WEP2 was never really produced since the entire
							WEP algorithm was found to be secure, not just the IV-stream
							correlation. Extending the key lengths was rolled into TKIP,
							just like EAP.

							<h3>Upgrade</h3>
							The only real solution to WEP's inherent issues is to upgrade
							per IEEE 802.11i to WPA or WPA2. Note that WPA has been broken
							as well and WPA2 can be insecure in some instances, so even
							this is not a perfect solution. However they are considerably
							more difficult to crack
						</div>
					</section>

					<section id="wpa" class="five">
						<div class="container">

							<header>
								<h2>WPA/WPA2</h2>
							</header>

							<h3>WPA</h3>

							<p>WPA was an intermediate solution designed for hardware incapable
							of supporting WPA2; basically WPA was a software implementable
							solution designed to replace WEP. WPA is based on the
							Temporary Key Integrity Protocol (TKIP), which has been replaced
							by AES in WPA due to being partially broken and deprecated.

							<h3>WPA2</h3>

							<p>WPA2 is based on Robust Security Network (RSN), which provides
							two new protocols: a four-way handshake and a group handshake.
							In a four-way handshake, nonces--cryptographic numbers used
							only once in a communication to keep originality of
							messages intact--are exchanged along with Pairwise Transient Keys
							(PTK), Groupwise Transient Keys (GTK) and Message Integrity
							Codes (MIC).

							<span class="image centered"><img src="images/4-way-handshake.png" alt=""></span>

							<p>WPA2's group handshake is utilized when the network timer
							expires, so the GTK needs to be updated. A two-way handshake
							is utilized instead of a four-way handshake, effectively
							the last two steps of the four-way handshake.

							<p> WPA2 is generally secure<sup><a href="#ref-8">8</a></sup>, however it is important to note
							that there are other attack vectors than just the security
							method chosen. For example, routers that have WPS pin enabled
							are nearly completely insecured even if they are using
							WPA2.

						</div>
					</section>

					<section id="references" class="five">
						<div class="container">

							<header>
								<h2>References</h2>
							</header>

							<a name="ref-1">[1]</a> <a href="http://ieeexplore.ieee.org/xpl/articleDetails.jsp?reload=true&arnumber=654749&isnumber=14251&punumber=5258&k2dockey=654749@ieeestds&query=%28802.11+1997%29%3Cin%3Emetadata&pos=0" target="_blank">802.11-1997  -  IEEE Standard for Information Technology- Telecommunications and Information Exchange Between Systems-Local and Metropolitan Area Networks-Specific Requirements-Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY) Specifications</a><br><br>

							<a name="ref-2">[2]</a> <a href="http://standards.ieee.org/getieee802/download/802.11i-2004.pdf" target="_blank">IEEE 802.11i-2004</a><br><br>

							<a name="ref-3">[3]</a> <a href="http://www.informit.com/guides/content.aspx?g=security&seqNum=85" target="_blank">WPA Part 2: Weak IV's</a><br><br>

							<a name="ref-4">[4]</a> <a href="http://www.cs.umd.edu/~waa/attack/v3dcmnt.htm" target="_blank">An Inductive Chosen Plaintext Attack against WEP/WEP2</a><br><br>

							<a name="ref-5">[5]</a> <a href="http://www.isaac.cs.berkeley.edu/isaac/mobicom.pdf" target="_blank">Intercepting Mobile Communications: The Insecurity of 802.11</a><br><br>

							<a name="ref-6">[6]</a> <a href="http://www.thefreelibrary.com/Agere+Systems+is+First+to+Solve+Wireless+LAN+Wired+Equivalent+Privacy...-a079954213" target="_blank">Agere Systems is First to Solve Wireless LAN Wired Equivalent Privacy Security Issue; New Software Prevents Creation of Weak WEP Keys.</a><br><br>

							<a name="ref-7">[7]</a> <a href="http://www.starkrealities.com/wireless003.html" target="_blank">WEP2, Credibility Zero</a><br><br>

							<a name="ref-8">[8]</a> <a href="http://www.networkmagazineindia.com/200112/focus3.htm" target="_blank">802.11b Update: Stepping Up Your WLAN Security</a><br><br>

						</div>
					</section>
				</div>
		<!-- Main -- >

		<!-- Footer -->
			<div id="footer">
				<!-- Copyright -->
					<div class="copyright">
						<p>&copy; 2014 Jordan Bayles, John Zeller. All rights reserved.</p>
						<ul class="menu">
							<li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
						</ul>
					</div>
			</div>

	</body>
</html>
