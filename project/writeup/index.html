<!DOCTYPE HTML>
<!--
	CONTENT:
		AUTHORS: Jordan Bayles, John Zeller
		DESCRIPTION: WEP security project for ECE 478: Network Security

	TEMPLATE:
	Prologue 1.2 by HTML5 UP
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->

<html>
	<head>
		<title>Wireless Network Security</title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta name="description" content="" />
		<meta name="keywords" content="" />
		<link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600" rel="stylesheet" type="text/css" />
		<!--[if lte IE 8]><script src="js/html5shiv.js"></script><![endif]-->
		<script src="js/jquery.min.js"></script>
		<script src="js/skel.min.js"></script>
		<script src="js/skel-panels.min.js"></script>
		<script src="js/init.js"></script>
		<script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js?skin=doxy"></script>
		<noscript>
			<link rel="stylesheet" href="css/skel-noscript.css" />
			<link rel="stylesheet" href="css/style.css" />
			<link rel="stylesheet" href="css/style-wide.css" />
			<link rel="stylesheet" href="css/doxy.css" />
		</noscript>
		<!--[if lte IE 9]><link rel="stylesheet" href="css/ie9.css" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="css/ie8.css" /><![endif]-->
	</head>
	<body>

		<!-- Header -->
			<div id="header" class="skel-panels-fixed">

				<div class="top">

					<!-- Logo -->
						<div id="logo">
							<span class="image avatar48"><img src="images/avatar.jpg" alt="" /></span>
							<h1 id="title">Wired Equivalent Privacy<h1>
              <span class="byline">Security Topics</span>
						</div>

					<!-- Nav -->
						<nav id="nav">
							<!--

								Prologue's nav expects links in one of two formats:
								
								1. Hash link (scrolls to a different section within the page)
								
								   <li><a href="#foobar" id="foobar-link" class="skel-panels-ignoreHref"><span class="fa fa-whatever-icon-you-want">Foobar</span></a></li>

								2. Standard link (sends the user to another page/site)

								   <li><a href="http://foobar.tld"><span class="fa fa-whatever-icon-you-want">Foobar</span></a></li>

							-->
							<ul>
								<li><a href="#top" id="top-link" class="skel-panels-ignoreHref"><span class="fa fa-cloud">Intro</span></a></li>
								<li><a href="#background" id="background-link" class="skel-panels-ignoreHref"><span class="fa fa-cogs">Background</span></a></li>
								<li><a href="#protocol" id="protocol-link" class="skel-panels-ignoreHref"><span class="fa fa-exchange">Protocol</span></a></li>
								<li><a href="#exploits" id="exploits-link" class="skel-panels-ignoreHref"><span class="fa fa-exclamation-triangle">Exploits</span></a></li>
								<li><a href="#remedies" id="remedies-link" class="skel-panels-ignoreHref"><span class="fa fa-shield">Remedies</span></a></li>
							</ul>
						</nav>

				</div>

				<div class="bottom">

					<!-- Social Icons
						<ul class="icons">
							<li><a href="#" class="fa fa-twitter solo"><span>Twitter</span></a></li>
							<li><a href="#" class="fa fa-facebook solo"><span>Facebook</span></a></li>
							<li><a href="#" class="fa fa-github solo"><span>Github</span></a></li>
							<li><a href="#" class="fa fa-dribbble solo"><span>Dribbble</span></a></li>
							<li><a href="#" class="fa fa-envelope solo"><span>Email</span></a></li>
						</ul>
					-->

				</div>

			</div>

		<!-- Main -->
			<div id="main">

				<!-- Intro -->
					<section id="top" class="one">
						<div class="container">

							<header>
							</header>

							<footer>
							</footer>

						</div>
					</section>

				<!-- Background -->
					<section id="background" class="two">
						<div class="container">
							<header>
								<h2>Background</h2>
							</header>

							<p>Wired Equivalent Privacy (WEP) was introduced in September 1999
							as a part of the original IEEE 802.11 standard. The purpose
							of WEP was to provide data confidentiality similar to existing
							wired networks.

							<h3>WEP-x origins</h3>

							<p>The original standard was WEP-40; due to US government export
							restrictions on cryptographic technology, the key size
							was limited to 40-bits in the standard 64-bit WEP. In 2000, the
							US government export restrictions were lifted and WEP-104, a
							128-bit system, was introduced by hardware manufacturers.

							<h3> Superceding of WEP </h3>

							<p>In 2003, the Wi-Fi Alliance announced that WEP had been superceded
							by Wi-Fi Protected Access (WPA). In 2004, IEEE 802.11i introduced
							WPA2 and deprecated both WEP-40 and WEP-104, stating that they
							"fail to meet their security goals."

						</div>
					</section>

				<!-- Protocol-->
					<section id="protocol" class="three">
						<div class="container">

							<header>
								<h2>Protocol</h2>
							</header>

						</div>
					</section>

				<!-- Exploits -->
					<section id="exploits" class="three">
						<div class="container">

							<header>
								<h2>Exploits</h2>
							</header>

							<p>There are several attack vectors for WEP. Because it is based
							on an RC4 stream cipher, the same traffic key cannot be reused
							securely. The cipher is seeded with an IV--transmitted as plain
							text--which is only 24 bits in the most common variation of WEP:
							not enough to be secure on a busy network. For a 24-bit IV, there
							is a 50 percent probability of repetition after only 5000 packets
							due to the birthday principle. The way the IV is utilized also
							opens WEP up to a related key attack, where a mathematical
							relationship between keys can be known to the attacker.

							<p>Other major issues include that the use of WEP is optional on
							most routers, so many installations don't even bother using it
							at all. Even if it is being used, the default implementation of
							WEP uses a single shared key among users which leads to issues
							dealing with compromises. Often compromises aren't dealt with at all.

							<p>Most attacks deal with issues due to the RC4 stream cipher utilization
							technique, but Bittau, Handley, and Lackey showed in 2006 that
							the 802.11 protocol can be used to enable attacks against WEP
							that weren't thought previously possible. Only a single packet
							needs to be eavesdropped before bootstrapping to arbitrary data.

							<h3>RC4 based exploits</h3>

							<p>Most exploits are based on the RC4 stream itself. Fluhrer,
							Mantin and Shamir (FMS) found correlations between the RC4
							keystream, IV, and shared key allowing a passive, eavesdropping
							based attack to recover the RC4 key. Depending on the
							amount of traffic on the network successful key recovery can
							take only a minute or so. A key element of this attack strategy
							is to stimulate the server by injecting packets, causing more
							traffic to be available to monitor them. This attack can be
							done easily with consumer hardware.

							<p>Improvements to FMS were made by Andreas Klein in 2005, showing
							that there are additional correlations in the RC4 stream cipher
							than FMS had found previously. This increases the ease of cracking
							the cipher.

							<p>Klein's attack was improved by Tews, Pychkine and Weinmann (TPW)
							in 2007, extending the capability of this attack method. The
							new implementation allows recovering a WEP-104 key with a
							high probability of 50% with only 40,000 packets, reaching
							95% probability with only 95,000 packets.

							<h3>aircrack-ng suite</h3>
							Aircrack-ng is a WEP and WPA-PSK cracking suite that enables
							users to collect packets from a server and perform analysis to
							recover keys from stored packets. It is one of the fastest
							free, consumer WEP cracking tools, implementing the FMS attack
							mentioned above, albeit with optimizations including KoreK, and
							the PTW attack. Aircrack-ng is used by many security companies
							to audit wireless networks.

							<p>At its simplest, aircrack-ng is intuitive and simply for power
							users. Assuming you are close enough to the access point to
							transmit and receive packets, the network has at least one
							client attached, your drivers are properly set up for injection,
							and you are using a current version of aircrack-ng, the
							process is simple to crack WEP. We will discuss the tool
							by walking through the process of cracking a simple WEP-40
							connection.

<h4>airmon-ng</h4>
<p>The first step is to set the wireless card into monitor mode
on the channel of the AP you want to crack. Typically this
is 6 if you are war driving, though you can check the channel
of a particular network easily. First you must put down the
network card with</p>
<pre class="prettyprint linenums">
airmon-ng stop (network interface)
</pre>

<p>Then you place the wireless card into monitor mode with
<pre class="prettyprint linenums">
airmon-ng start (network interface) (AP channel)
</pre>

<h4>airodump-ng</h4>
<p>After the wireless card is prepared to monitor packets, you can
start monitoring packets over the connection using airodump-ng.
The syntax is
<pre class="prettyprint linenums">
airodump-ng -c (AP channel) --bssid (BSSID of AP) -w (output filename) (network interface)
</pre>

Airodump in progress
<span class="image centered"><img src="images/aircrack/airodump_working.png" alt=""></img></span>

<h4>aireplay-ng</h4>
<p>After monitoring has started, packets are being collected. Given enough time
this will likely be enough to collected sufficient packets for recovering the
key, however this is not necessary. Typically while cracking you want to
use aireplay-ng to get a fake authentication, which allows the hacking
laptop to associate with the desired AP and have it accept packets. This gives
more response packets from the server and allows for packet injection.

<pre class="prettyprint linenums">
aireplay-ng -1 0 -e (ESSID of AP) -a (BSSID of AP) -h (MAC of network interface) (network interface)
</pre>

<p>After we have fake associated, everything is ready to begin packet injection.
The easiest way to do this is when a client is currently on the access point,
meaning that address resolution protocol (ARP) requests are being sent
out from the server. ARP packets are ideal because the AP typically broadcasts
them to build the ARP request result, simultaneously spawning a new IV for
collection. We wait for ARP requests to come across the monitor, and then
when we find one we inject it for more packets. There are also tricks for
generating ARPs without a client present, but if conditions are met you
can starting injecting using
<pre class="prettyprint linenums">
aireplay-ng -3 -b (BSSID of AP) -h (MAC of network interface) (network interface)
</pre>

<h4>aircrack-ng</h4>
<p>After collecting enough IVs ("enough" depends on your attack strategy, but
typically 50,000 may be enough) we can now obtain the WEP key directly. This
is done using FMS or PTW implicitly through the aircrack-ng command. For
PTW:
<pre class="prettyprint linenums">
aircrack-ng -b (BSSID of AP) (output filename)*.cap
</pre>

<p>To use the FMS/KoreK method, you can start another console session and use
<pre class="prettyprint linenums">
aircrack-ng -K -b (BSSID of AP) (output filename)*.cap
</pre>

<p>Aircrack with FMS works by using statistical correlations between the RC4
stream cipher and the key to "vote" on the probatility of specific bytes
being at certain positions in the shared key. This allows for a more
educated attack than brute force, in which keys are generated from high probability
bytes and tested against the target AP. In basic WEP configurations the
AP will NOT lock out the aircrack-ng instance, allowing this process to be
completed fairly quickly. Aircrack FMS in progress shows the keys being
tested.
<span class="image centered"><img src="images/aircrack/aircrack-fms.png" alt=""></img></span>

If everything has gone correctly to this point, you should get the key
as a result:
<span class="image centered"><img src="images/aircrack/success.png" alt=""></img></span>

						</div>
					</section>

				<!-- Remedies -->
					<section id="remedies" class="four">
						<div class="container">

							<header>
								<h2>Remedies</h2>
							</header>

						</div>
					</section>

			</div>

		<!-- Footer -->
			<div id="footer">
				<!-- Copyright -->
					<div class="copyright">
						<p>&copy; 2014 Jordan Bayles, John Zeller. All rights reserved.</p>
						<ul class="menu">
							<li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
						</ul>
					</div>
			</div>

	</body>
</html>
